import numpy as np
import matplotlib.pyplot as plt

filter_coefs = [2.1804394561215686e-06, 7.307213539159978e-06, -3.827449953166632e-06, -1.4704540164019638e-05, 3.3367975113573343e-07, 2.8159131092762438e-05, 1.1167249741906437e-05, -4.416534273865827e-05, -3.661105503672574e-05, 5.733435304013607e-05, 8.078317610919384e-05, -5.763052084539841e-05, -0.0001453858201804361, 3.0666856104380794e-05, 0.0002258620282978998, 4.056900826626298e-05, -0.00030831882944288896, -0.00017203222519024828, 0.0003674277018298899, 0.00037300120240838105, -0.00036651161331593854, -0.0006392079118629813, 0.00026082827462677586, 0.0009459340394524694, -4.714989220599039e-06, -0.0012428881934381962, -0.0004375037249085257, 0.0014528732430846628, 0.0010778933037575956, -0.0014761146027485246, -0.0018906274832902327, 0.001201438616970056, 0.002799916832082243, -0.0005243490768165171, -0.0036733848501805328, -0.0006293437919894823, 0.004323894493194634, 0.002277193333147555, -0.004521857372400284, -0.004355041875733149, 0.004018432361160899, 0.006697649371843505, -0.002577981761373245, -0.009028932733824867, 1.6049239798177332e-05, 0.010964016532447503, 0.003762616934983964, -0.012022173026535866, -0.00873241393718241, 0.011644736846185128, 0.014727897127973032, -0.009203865740471018, -0.021442350947156043, 0.0039711052879326724, 0.028446433474786453, 0.005030229352636568, -0.035226192854648196, -0.019520876613283798, 0.04123651346991793, 0.043757133709014025, -0.04596309477471016, -0.09358118837624176, 0.048984251977186796, 0.31403596892799635, 0.44997659139669505, 0.31403596892799635, 0.048984251977186796, -0.09358118837624176, -0.04596309477471016, 0.043757133709014025, 0.04123651346991793, -0.019520876613283798, -0.035226192854648196, 0.005030229352636568, 0.028446433474786453, 0.0039711052879326724, -0.021442350947156043, -0.009203865740471018, 0.014727897127973032, 0.011644736846185128, -0.00873241393718241, -0.012022173026535866, 0.003762616934983964, 0.010964016532447503, 1.6049239798177332e-05, -0.009028932733824867, -0.002577981761373245, 0.006697649371843505, 0.004018432361160899, -0.004355041875733149, -0.004521857372400284, 0.002277193333147555, 0.004323894493194634, -0.0006293437919894823, -0.0036733848501805328, -0.0005243490768165171, 0.002799916832082243, 0.001201438616970056, -0.0018906274832902327, -0.0014761146027485246, 0.0010778933037575956, 0.0014528732430846628, -0.0004375037249085257, -0.0012428881934381962, -4.714989220599039e-06, 0.0009459340394524694, 0.00026082827462677586, -0.0006392079118629813, -0.00036651161331593854, 0.00037300120240838105, 0.0003674277018298899, -0.00017203222519024828, -0.00030831882944288896, 4.056900826626298e-05, 0.0002258620282978998, 3.0666856104380794e-05, -0.0001453858201804361, -5.763052084539841e-05, 8.078317610919384e-05, 5.733435304013607e-05, -3.661105503672574e-05, -4.416534273865827e-05, 1.1167249741906437e-05, 2.8159131092762438e-05, 3.3367975113573343e-07, -1.4704540164019638e-05, -3.827449953166632e-06, 7.307213539159978e-06, 2.1804394561215686e-06]
filter_length = len(filter_coefs)

# data = np.zeros(300-129)

data = [8.1391238760e-1,  -3.4693258070,   1.5201495470,  -6.9607663990e-1,  1.2821842370, -9.4294664070e-1,  -1.2468875430,   6.7424480290e-1,   5.1884466770e-1,  -1.6437894720, 2.8602594250e-1,  -2.3512103080e-1,  -5.3793871390e-1,   1.1996164370e-1,   1.0092801030, 1.3206833180,  -1.1950826740,  -1.8550034290,   3.0186776810e-1,   6.2135746720e-1, -1.1102497020,   1.5827647410,   1.9540900340e-3,  -4.7462806940e-2,  -4.3911567620e-1, -1.5607751770e-2,  -9.4915673960e-1,   1.7345781510e-1,   4.6529056250e-2,  -2.2654345310, -7.2666234940e-1,  -2.6697228140e-1,  -4.4409063070e-1,  -9.3429235550e-2,  -6.5190298900e-1, 1.8145445310,  -5.5297038690e-2,   7.4424721390e-1,  -1.0596921740e-1,   3.7816943570e-1, 9.7830606100e-1,   4.1543486100e-1,  -5.5865912210e-2,  -1.5234621900,  -1.3448331090, -1.2407090010e-1,   1.3509417750, -2.6757915470e-1,  -1.1650090670,   4.4237287240e-1, -8.4978940830e-1,  -1.0946572120,   1.4358658310,   5.9467242620e-1,   1.3385688280, 5.5589583860e-2,  -6.1583655480e-1,   5.1388504280e-1,   1.0817893680,  -4.6920119830e-1, 1.3977660400,  -4.6805862390e-1,   4.2938931900e-1,   3.5457727620e-1,   7.2455681580e-1, 1.7229042460e-1,   9.2376461650e-3,  -2.1470754640e-2,   4.9689884770e-1,  -8.1785833620e-1, 4.0752684200e-2,   3.0564365170e-1,   6.6904512710e-1,   1.2752005500,  -6.4261937030e-1, -5.3495336520e-1,  -1.0202526060,  2.9529103660e-1,  -6.2960149470e-1,  -1.2955512230, -5.7763497870e-1,  -1.2530606220,   6.2475393960e-1,  -2.4019566170e-1,  -1.5894838820, 4.9059933290e-2,  -4.9200310870e-2,   1.0956288130,   7.1335817120e-1,  -1.2081544860, 7.7961369150e-2,   1.6462085160e-1,  -4.6352249090e-1,  -1.4745262160,   7.3274782410e-1, -9.9120420280e-1,  -9.3533672940e-1,   1.1698416510,  -2.7092539470e-1,   8.6698658150e-1, 1.8738833910,   1.3897518540,   2.3980928280e-1,   1.4723337270,  -8.3434370050e-1, 5.0058636610e-2,  -8.8174192310e-1,  -4.4721598590e-1,   1.2714430200,   1.4100208970, 1.0090014730,  -9.0636626260e-1,  -1.9688300470,  -7.0039467260e-1,   1.6712503330, -1.5284609130e-1,   9.5171487270e-1,  -1.1256892530,  -1.2983113690e-1,   4.2413555710e-1, 1.7380586460,  -2.0318337990,  -1.9184102890e-1,  -1.2524904440,   5.4525814950e-1, 5.6603965450e-1,   6.7117736490e-2,   8.9796160220e-1,   8.8627274620e-1]

plt.figure()
plt.plot(range(len(data)), data)

padded_data = np.zeros(len(data) + filter_length)
padded_data[filter_length:] = data
# padded_data[filter_length] = 1.0

output_data = np.copy(padded_data)

for i in range(filter_length, len(padded_data)):
    sum = 0
    for j in range(filter_length):
        sum += filter_coefs[j] * padded_data[i - j]
    output_data[i] = sum

output_data = output_data[filter_length:]
plt.figure()
plt.plot(range(len(output_data)), output_data)

# test = [0.000002, 0.000009, 0.000006, -0.000009, -0.000009, 0.000019, 0.000031, -0.000014, -0.000050, 0.000007, 0.000088, 0.000030, -0.000115, -0.000084, 0.000141, 0.000182, -0.000126, -0.000298, 0.000069, 0.000442, 0.000076, -0.000564, -0.000303, 0.000643, 0.000638, -0.000604, -0.001042, 0.000411, 0.001489, 0.000013, -0.001878, -0.000676, 0.002123, 0.001599, -0.002074, -0.002704, 0.001620, 0.003897, -0.000624, -0.004979, -0.000961, 0.005737, 0.003159, -0.005870, -0.005854, 0.005110, 0.008872, -0.003150, -0.011882, -0.000237, 0.014490, 0.005287, -0.016156, -0.012185, 0.016262, 0.021292, -0.013934, -0.033455, 0.007781, 0.051539, 0.005575, -0.088006, -0.039021, 0.275015, 0.724991, 1.039027, 1.088011, 0.994430, 0.948467, 0.992224, 1.033461, 1.013940, 0.978714, 0.983744, 1.012190, 1.016161, 0.994719, 0.985515, 1.000243, 1.011888, 1.003155, 0.991133, 0.994896, 1.005860, 1.005876, 0.996847, 0.994269, 1.000967, 1.004985, 1.000630, 0.996108, 0.998385, 1.002709, 1.002080, 0.998407, 0.997882, 1.000682, 1.001884, 0.999993, 0.998517, 0.999595, 1.001048, 1.000610, 0.999367, 0.999363, 1.000309, 1.000569, 0.999930, 0.999564, 0.999937, 1.000304, 1.000132, 0.999824, 0.999864, 1.000090, 1.000121, 0.999976, 0.999918, 0.999999, 1.000056, 1.000019, 0.999975, 0.999986, 1.000014, 1.000015, 1.000000, 0.999996, 1.000004, 1.000006, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
# 0.000000, 0.000000, 0.000000, 0.000000, -0.000001, 0.000000, -0.000001, 0.000000, -959892362019182527582872065277952.000000, 0.000000, 0.000000, 0.000000, "-nan", 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
# 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000001, 0.000000, 0.000000, 0.000000]
# # print(len(test))

# test2 = [0.000002, 0.000009, 0.000006, -0.000009, -0.000009, 0.000019, 0.000031, -0.000014, -0.000050, 0.000007, 0.000088, 0.000030, -0.000115, -0.000084, 0.000141, 0.000182, -0.000126, -0.000298, 0.000069, 0.000442, 0.000076, -0.000564, -0.000303, 0.000643, 0.000638, -0.000604, -0.001042, 0.000411, 0.001489, 0.000013, -0.001878, -0.000676, 0.002123, 0.001599, -0.002074, -0.002704, 0.001620, 0.003897, -0.000624, -0.004979, -0.000961, 0.005737, 0.003159, -0.005870, -0.005854, 0.005110, 0.008872, -0.003150, -0.011882, -0.000237, 0.014490, 0.005287, -0.016156, -0.012185, 0.016262, 0.021292, -0.013934, -0.033455, 0.007781, 0.051539, 0.005575, -0.088006, -0.039021, 0.275015, 0.724991, 1.039027, 1.088011, 0.994430, 0.948467, 0.992224, 1.033461, 1.013940, 0.978714, 0.983744, 1.012190, 1.016161, 0.994719, 0.985515, 1.000243, 1.011888, 1.003155, 0.991133, 0.994896, 1.005860, 1.005876, 0.996847, 0.994269, 1.000967, 1.004985, 1.000630, 0.996108, 0.998385, 1.002709, 1.002080, 0.998407, 0.997882, 1.000682, 1.001884, 0.999993, 0.998517, 0.999595, 1.001048, 1.000610, 0.999367, 0.999363, 1.000309, 1.000569, 0.999930, 0.999564, 0.999937, 1.000304, 1.000132, 0.999824, 0.999864, 1.000090, 1.000121, 0.999976, 0.999918, 0.999999, 1.000056, 1.000019, 0.999975, 0.999986, 1.000014, 1.000015, 1.000000, 0.999996, 1.000004, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006, 1.000006]
# print(len(test2))
plt.show()
# str_out = ""
# for num in output_data:
#     str_out += str(num) + ", "

# str_out = str_out[:-2]
# print(str_out)